# Story 2.2: Client-Side Routing and Recipe Navigation

## Status

Ready for Review

## Story

**As a** user,
**I want** to click on a recipe in the sidebar to view it in the main content area,
**so that** I can easily browse between different recipes.

## Acceptance Criteria

1. React Router installed and configured with hash-based routing
2. Routes defined: `/#/` (home with blank main area) and `/#/recipe/:recipeName`
3. RecipeList items converted to clickable links that navigate to recipe routes
4. Clicking a recipe in sidebar loads and displays it in main content area
5. URL updates to reflect current recipe (e.g., `/#/recipe/chocolate-chip-cookies`)
6. Browser back/forward buttons work correctly
7. Direct navigation to recipe URL loads the correct recipe
8. Active recipe highlighted in sidebar list
9. Component tests verify clicking recipe list item triggers navigation
10. Integration tests verify routing loads correct recipe content

## Tasks / Subtasks

- [x] Install react-router-dom
- [x] Configure HashRouter in App.tsx
- [x] Create HomePage component for root route
- [x] Create RecipeDetailPage with dynamic recipe loading
- [x] Update RecipeList to use Link components
- [x] Implement active recipe highlighting
- [x] Add error handling for invalid recipe slugs
- [x] Write routing integration tests
- [x] Write RecipeDetailPage component tests
- [x] Update RecipeList tests for router context
- [x] Verify all tests pass (47 total) and build succeeds

## Dev Notes

### Relevant Architecture Information

**Epic Context:**
- Builds on Story 2.1 (Recipe List and Metadata Loading)
- Enables navigation between recipes in the collection
- Foundation for Stories 2.3 (Search) and 2.4 (Tag Filtering)

**Routing Strategy:**
- **Hash-based routing** (`/#/recipe/...`) required for GitHub Pages compatibility
- React Router v6+ with `HashRouter`
- Route parameters extract recipe slug from URL

**Route Structure:**
```
/#/                          → Home view (empty main area or welcome message)
/#/recipe/:recipeSlug        → Recipe detail view
```

**Component Architecture:**
```
App
├── HashRouter
│   ├── Routes
│   │   ├── Route path="/" → HomePage (blank main area)
│   │   └── Route path="/recipe/:recipeSlug" → RecipeDetailPage
│   └── Layout (two-panel)
│       ├── Sidebar
│       │   └── RecipeList (clickable links)
│       └── MainContent
│           └── Outlet (renders route component)
```

**Navigation Implementation:**
- RecipeListItem uses React Router's `Link` component
- `to` prop: `/recipe/${recipe.slug}`
- Active state styling via `NavLink` or custom hook using `useLocation()`

**Recipe Loading:**
- Recipe detail page uses `useParams()` to get `recipeSlug`
- Dynamically imports recipe markdown content based on slug
- Displays using RecipeDisplay component from Epic 1

**Active Recipe Highlighting:**
- Use `useLocation()` hook to get current path
- Compare with recipe slug to determine active state
- Apply active styling (background color, border, etc.)

**Libraries:**
- `react-router-dom` v6+
- Use `HashRouter` instead of `BrowserRouter`

### Testing

**Test Location:**
- `tests/components/RecipeList.test.tsx` - Navigation triggering tests
- `tests/integration/routing.test.tsx` - End-to-end routing tests
- `tests/pages/RecipeDetailPage.test.tsx` - Recipe loading tests

**Component Tests:**
- Test clicking recipe list item navigates to correct URL
- Test active recipe styling applied correctly
- Test recipe list items render as links with correct href

**Integration Tests:**
- Test navigation from home to recipe detail
- Test browser back button returns to previous state
- Test browser forward button works
- Test direct URL navigation loads correct recipe
- Test invalid recipe slug shows error state

**Test Utilities:**
- Use React Router's `MemoryRouter` for testing
- Mock recipe data for consistent test results

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-12-09 | 1.0 | Initial story creation from Epic 2 | John (PM) |

## Dev Agent Record

### Agent Model Used
Claude Sonnet 4.5 (claude-sonnet-4-5-20250929)

### Implementation Summary
- Installed react-router-dom v6
- Configured HashRouter for GitHub Pages compatibility
- Created HomePage component with welcome message
- Created RecipeDetailPage with dynamic recipe loading via import()
- Updated RecipeList to use Link components with active state highlighting
- Active recipe shows blue background (bg-blue-50 border-blue-300)
- Error handling for non-existent recipes and missing slugs
- All 47 tests passing (8 RecipeList + 5 routing integration + 4 RecipeDetailPage)
- Code splitting working: each recipe bundled as separate chunk

### File List
- `/src/pages/HomePage.tsx` (new)
- `/src/pages/RecipeDetailPage.tsx` (new)
- `/tests/integration/routing.test.tsx` (new)
- `/tests/pages/RecipeDetailPage.test.tsx` (new)
- `/src/App.tsx` (modified - added HashRouter and Routes)
- `/src/components/recipe/RecipeList.tsx` (modified - added Link and active highlighting)
- `/tests/components/RecipeList.test.tsx` (modified - added router context and new tests)
- `/package.json` (modified - added react-router-dom dependency)

### Debug Log References
None

### Completion Notes
- All acceptance criteria met
- Hash-based routing configured (/#/ and /#/recipe/:recipeName)
- Browser back/forward navigation works
- Direct URL navigation supported
- Active recipe highlighted in sidebar
- Loading and error states properly handled
- Recipe files dynamically imported and code-split
- Build output shows separate chunks for each recipe file

### Change Log
N/A - Implementation changes tracked in main Change Log

## QA Results

_To be populated by QA agent_
